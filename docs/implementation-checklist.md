# 実装チェックリスト

## Phase 1: 基盤強化

### SecretsManagerAdapterクラス作成

- [ ] `src/secretsManager.ts` ファイル作成
- [ ] AWS SDK for JavaScript v3 の Secrets Manager クライアント実装
- [ ] 認証情報取得メソッド `getCredentials()` 実装
- [ ] 型定義（認証情報インターフェース）作成
- [ ] エラーハンドリング実装
- [ ] 単体テスト作成

### エラーハンドリング強化

- [ ] `src/monthlyEndBusinessDayCheck.ts` のエラーハンドリング強化
- [ ] 構造化ログ出力実装（info/error/warn）
- [ ] 適切な例外スロー処理実装
- [ ] ログ出力レベルの設定

### 既存機能の動作確認

- [ ] 現在のシステムの動作確認
- [ ] 既存テストの実行・確認
- [ ] エラーケースの動作確認

## Phase 2: 機能追加

### Googleカレンダー予定追加機能実装

- [ ] `src/googleCalendar.ts` の `addEvent` メソッド修正
- [ ] リマインド設定（3時間前、2時間前、1時間前）実装
- [ ] タイムゾーン設定（JST）確認
- [ ] 予定時間設定（17:00-17:15）実装
- [ ] 予定タイトル設定（「月末の最終営業日」）実装

### メイン処理統合

- [ ] `src/monthlyEndBusinessDayCheck.ts` の予定追加処理統合
- [ ] SecretsManagerAdapter の統合
- [ ] エラーハンドリングの統合
- [ ] ログ出力の統合

### CDKスタック修正

- [ ] `lib/monthly_end-business_day_check-stack.ts` のデッドレターキュー設定追加
- [ ] SQS デッドレターキュー作成
- [ ] EventBridge ルール（再実行用）作成
- [ ] Lambda関数（再実行用）作成
- [ ] IAM権限設定

## Phase 3: テスト・デプロイ

### 単体テスト

- [ ] SecretsManagerAdapter の単体テスト
- [ ] GoogleCalendarAdapter の単体テスト（リマインド設定含む）
- [ ] BusinessDayChecker の単体テスト
- [ ] LineNotifyAdapter の単体テスト

### 統合テスト

- [ ] 月末最終営業日判定フローの統合テスト
- [ ] 通知送信フローの統合テスト
- [ ] 予定追加フローの統合テスト
- [ ] エラーハンドリングフローの統合テスト

### デプロイ・動作確認

- [ ] AWS CDK デプロイ
- [ ] 本番環境での動作確認
- [ ] エラー時の再試行確認
- [ ] ログ出力確認
- [ ] 外部API連携確認

## 技術的チェック項目

### セキュリティ

- [ ] 認証情報の適切な管理（Secrets Manager）
- [ ] IAM権限の最小権限原則
- [ ] 環境変数の適切な設定

### パフォーマンス

- [ ] Lambda関数のタイムアウト設定（30秒）
- [ ] 外部API呼び出しの最適化
- [ ] メモリ使用量の最適化

### エラーハンドリング

- [ ] デッドレターキュー機能の動作確認
- [ ] 再試行回数の制限（3回）
- [ ] エラーログの詳細出力

### ログ出力

- [ ] 構造化ログ（JSON形式）の出力
- [ ] ログレベルの適切な設定
- [ ] CloudWatch Logs での確認

## 動作確認項目

### 基本動作

- [ ] 毎日朝9時の定期実行
- [ ] 月末最終営業日の判定
- [ ] LINE通知の送信
- [ ] Googleカレンダーへの予定追加

### エラーケース

- [ ] 認証情報取得エラー時の再試行
- [ ] 外部API通信エラー時の再試行
- [ ] 処理エラー時の再試行
- [ ] 最大再試行回数到達時の処理

### ログ確認

- [ ] 正常時のログ出力
- [ ] エラー時のログ出力
- [ ] 再試行時のログ出力
- [ ] ログレベルの確認

## 最終確認項目

### 機能確認

- [ ] 全ての機能要件の実装完了
- [ ] 非機能要件の実装完了
- [ ] エラーハンドリングの実装完了

### 品質確認

- [ ] コードレビューの完了
- [ ] テストの実行完了
- [ ] セキュリティチェックの完了

### ドキュメント確認

- [ ] README.md の更新
- [ ] 技術ドキュメントの更新
- [ ] 運用ドキュメントの更新

---

**チェックリスト作成日**: 2025年6月26日
**作成者**: AI Assistant
**バージョン**: 1.0
